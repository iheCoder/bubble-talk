# BubbleTalk Server Configuration

server:
  host: "0.0.0.0"
  port: 8080
  read_timeout: 30s
  write_timeout: 30s

# OpenAI Realtime API配置
openai:
  api_key: ""  # 可以从环境变量读取，或直接填写
  realtime_url: "wss://api.openai.com/v1/realtime?model=gpt-realtime-2025-08-28"
  model: "gpt-realtime-2025-08-28"
  voice: "cedar"
  temperature: 0.8
  max_response_output_tokens: 4096

# LLM配置（用于导演决策）
llm:
  provider: "openai"  # 可选: "openai", "anthropic"
  openai:
    api_key: ""  # 可以从环境变量 LLM_API_KEY 读取
    api_url: "https://api.openai.com/v1"
    model: "gpt-5-nano-2025-08-07"
    temperature: 1
    max_tokens: 4096  # JSON 结构化输出需要足够的 tokens
  anthropic:
    api_key: ""  # 可以从环境变量 ANTHROPIC_API_KEY 读取
    api_url: "https://api.anthropic.com/v1"
    model: "claude-3-5-sonnet-20241022"  # 或其他 Claude 模型
    temperature: 0.7
    max_tokens: 4096  # JSON 结构化输出需要足够的 tokens

# Gateway配置
gateway:
  default_instructions: |
    You are a Socratic tutor in a learning conversation.
    Guide users to discover answers through questioning.
    Keep responses under 20 seconds when spoken aloud.
  input_audio_format: "pcm16"
  output_audio_format: "pcm16"
  input_audio_transcription_model: "gpt-4o-mini-transcribe"
  ping_interval: 30s

# Director Engine配置
director:
  # 是否启用 LLM 进行拍点选择和选角决策
  enable_llm: true
  available_roles:
    - host
    - economist
    - skeptic
  available_beats:
    - reveal
    - check
    - deepen
    - twist
    - continue
    - lens_shift
    - feynman
    - montage
    - minigame
    - exit_ticket
  default_talk_burst_limit: 20  # 秒
  high_load_talk_burst_limit: 15  # 秒
  output_clock_threshold: 90  # 秒，超过此值强制选择输出型Beat

# Actor Engine配置
actor:
  prompts_dir: "server/configs/prompts"
  max_prompt_length: 2000  # 字符

# Session配置
session:
  default_timeout: 30m
  max_inactive_time: 10m
  max_sessions_per_user: 5

# Learning Model配置
learning:
  initial_mastery: 0.3
  mastery_update_rate: 0.1
  misconception_decay_rate: 0.05
  transfer_weight: 0.3

# 日志配置
logging:
  level: "info"  # debug, info, warn, error
  format: "json"  # json, text
  output: "stdout"

# 路径配置
paths:
  prompts: "server/configs/prompts"
  concepts: "server/configs/concepts_econ.json"
  bubbles: "server/configs/bubbles.json"
  scripts: "server/configs/scripts"

# 角色配置（可扩展更多字段）
roles:
  host:
    voice: "marin"
    avatar: "host.png"
  economist:
    voice: "cedar"
    avatar: "economist.png"
  skeptic:
    voice: "shimmer"
    avatar: "skeptic.png"
  educator:
    voice: "nova"
    avatar: "educator.png"
  psychologist:
    voice: "alloy"
    avatar: "psychologist.png"
  coach:
    voice: "echo"
    avatar: "coach.png"
  scientist:
    voice: "fable"
    avatar: "scientist.png"
