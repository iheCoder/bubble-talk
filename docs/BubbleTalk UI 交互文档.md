# BubbleTalk UI 交互文档（V1）

**主题：教育 × 科技｜“泡泡宇宙”入口 + “新世界”沉浸式对话课堂**

> 目标：让用户一打开 App 就感到“被吸进去”。
> 首页是一个可呼吸、会游动的“泡泡宇宙”。进入泡泡后像推开一扇门，落入一个有角色、有节奏、有仪式感的对话空间。
> 核心交互：**沉浸、轻盈、可控的节奏**。工具（题目/卡片/图解）出现要自然，像剧情中的道具而不是弹窗。

## 0. 设计总纲

### 0.1 视觉母题（Visual Motif）

- **教育感**：清晰、秩序、可读性、可复盘
- **科技感**：流动、粒子、玻璃、深空、微光、精密的动效逻辑
- **情绪感**：温柔但高级，不“幼稚可爱”，更像“未来学院”
- **关键词**：*Deep Space Classroom / Glass + Glow / Soft Physics / Quiet Power*

### 0.2 色彩与材质建议（可落地到 Design Tokens）

- 背景：深空渐变（深蓝-靛紫-暗青），有极淡噪点纹理（防“纯色假”）
- 元素：玻璃拟态（高斯模糊+细描边+微光晕）
- 强调：荧光青/薄荷绿（科技）、琥珀金（知识点亮时刻）、雾白（文本）
- 统一光源：**右上方冷光** + **局部暖光高亮**（学习“顿悟”出现时）

> 重要：所有动效都应“可解释”，像物理而不是花里胡哨。
> 泡泡游动靠“浮力+阻尼”，对话动效靠“呼吸+聚焦”，工具出现靠“道具入场”。

## 1. 信息架构（IA）

### 1.1 页面结构

1. **Home：Bubble Universe（泡泡宇宙）**
2. **World：Bubble Session（泡泡世界 / 课堂空间）**
3. （可选）**Profile：Avatar & Preferences（用户虚拟形象与偏好）**
4. （可选）**Library：Learned Cards（学习卡片回收站/收藏）**

> V1 必做：Home + World

## 2. Home：泡泡宇宙（不是列表，是“可探索的星云”）

### 2.1 宇宙画面构成

- **主舞台**：漂浮泡泡群（10～30 个）
- **远景层**：微弱星尘粒子（极慢）
- **中景层**：半透明流体云（可选，低频）
- **近景层**：少量漂浮几何碎片（提示科技感）

### 2.2 泡泡的形态（建议：文字 + 轻纹理 + 微光）

每个泡泡可包含：

- 主标题（短句、场景化而非概念名）
- 副钩子（1 行，增强点击欲）
- 领域标签（极淡图标或色环）

**例：**

- “周末加班值不值？”（机会成本的入口）
- “为什么你总是学了又忘？”（遗忘曲线/间隔重复）
- “为什么价格涨了你反而买更多？”（韦伯伦/吉芬）

>
> **泡泡标题要是“你的人生问题”，概念是背后的答案。**

### 2.3 泡泡的运动（“浮动感 + 游动”实现要点）

- 使用 2D 物理或简化力学：
    - 浮力：向上轻推
    - 阻尼：抑制抖动
    - 轻微噪声：让轨迹不机械
    - 碰撞：软碰撞（不要弹得像台球）
- 鼠标/触控交互：
    - 悬停：泡泡轻微变大、描边发光、标题清晰
    - 触碰：泡泡应被“吸住”，轻轻停驻在指针或手指附近，不再游走；此时泡泡表面可展开更多信息层，如定义、简短故事钩子、相关图标或关键词，形成“预览卡片”效果
    - 点击：泡泡进一步放大，展示完整细节或动画纹理，进入“新世界”前的过渡状态
    - 拖拽：泡泡可被轻微拖动，但有明显的“吸附感”，松手后缓慢回到原位
    - 轻推：扫过泡泡群产生涟漪（空间感）

**推荐动效语言：**

- “漂浮”速度：很慢（像深海浮游物）
- “呼吸”频率：3～5 秒一轮
- “聚焦”时：泡泡周围暗下来，泡泡更亮，触碰后短暂放大并显露多层信息（副标题、定义、故事钩子、图标等），保持被吸附的静止感

### 2.4 过滤与探索（不破坏美感）

- 不要传统筛选栏。
- 用一个“**星盘按钮**”展开半透明浮层：
    - 领域（经济/编程/心理…）
    - 难度（入门/进阶/挑战）
    - 形式偏好（更多题/更多故事/更多图解）
- 关闭浮层时泡泡群轻微重排（像星座重组）

### 2.5 点击泡泡：进入“新世界的大门”



**交互流程：**

1. 点击泡泡
2. 泡泡放大到占屏 60～80%
3. 周围泡泡被吸入远景并虚化
4. 泡泡表面出现“门纹”（细线网格/电路纹）
5. 一次短促的“穿越”动画：
    - 镜头推进
    - 光晕扫过
    - 背景从“宇宙”过渡到“课堂空间”

> 关键：不是页面跳转感，而是“镜头过场”。

## 3. World：泡泡世界（对话课堂空间）

**核心隐喻**：圆桌对谈（Round Table）。
不再是线性的聊天流，而是一个沉浸式的三方对话场。用户与两位AI角色（主持人、专家）围坐圆桌，进行语音为主的交流。

### 3.1 布局与视觉 (Layout & Visuals)

- **圆桌三角布局**：
  - **上方左侧**：主持人 (Host) - 引导者，控场。
  - **上方右侧**：专家角色 (Expert) - 如经济学家，提供深度知识。
  - **下方正中**：用户 (User) - 学习者，第一视角。
- **中央舞台 (Center Stage)**：
  - 圆桌中心是一块“全息托盘”，工具卡片从桌面缓缓升起并保持圆形/环形排布，仿佛剧情道具。
  - 角色台词与字幕在各自座位周围柔和浮现，随后淡出。
- **顶层“宇宙心跳”状态环**：
  - Header 不再是传统条状，而是一个悬浮在中心的 **Holo Hub**： holo hub 左侧为可点击的呼吸灯 (status node) 展示语音链路状态（灰=idle、绿=connected/listening、红=error），点击即可重连/断开；中部显示泡泡主题与领域，点击后 4 秒内浮现“离开课堂”按钮；右侧保留调试/系统按钮。
  - 无文字“连接语音”提示，呼吸灯颜色与波纹成为唯一状态信号，保持沉浸感。
  - 说话状态可视化：
    当角色说话时，其头像周围会有声波/光晕动效。

### 3.1.1 Holo Hub 细节（V1.5 更新）

1. **空间定位**：Holo Hub 悬浮在圆桌上方 15–18° 的“空域”中，像一颗缓慢转动的卫星；默认保持半透明玻璃体，不投下硬阴影，确保视线集中在圆桌。
2. **左翼呼吸灯（Status Node）**：
   - 形态：直径 18px 的光点 + 三层柔和波纹，默认灰色（Idle）。
   - 状态色：
     - 灰（#8A95A6，Alpha 0.65）：未连接或待命；波纹以 3s 呼吸节奏轻扩散。
     - 绿（#7CFFD3）：已连接+Listening；波纹以 1.2s 周期律动，象征能量流动。
     - 红（#FF7A7A）：异常或断线；波纹收缩成脉冲，提示用户轻触重连。
   - 交互：点击光点即调用 `connect()/disconnect()`，整个过程仅依赖颜色与呼吸动画，无文字提示（遵循“像 mac traffic-light”低打扰风格）。
3. **中央主题舱**：
   - 展示 `Bubble Title + Domain Tag`，排列成“主标题 + 极简字环”形式（主 18px，辅 12px，Uppercase 标签环抱周围）。
   - 用户点击主题舱，Holo Hub 会“微展开”：中心玻璃片向前推进 6px，同时唤出悬浮的 **Exit Glyph**（极细描边的 ⌫ 图标）。Glyph 停留 4 秒，期间可点击退出；若 4 秒无操作则自动淡出，主题收回原位。
   - 主题舱四角带有微弱粒子线路，暗示当前 Session 的概念网络；Hover/Focus 时粒子轻跳，反馈“已可交互”。
4. **右翼系统微按钮**：
   - 仅保留一个极小的退出圆钮：
   - 圆钮与 macOS 关闭/最小化/全屏按钮尺寸相似，但改用玻璃描边，避免真实桌面感破坏沉浸。
5. **音波同步**：Holo Hub 的底环与圆桌托盘的光环同步呼吸，确保“头顶的心跳”与“桌面的能量”一致，不显突兀。

### 3.1.2 托盘与角色布局校准

- 托盘（Tray）扩大到 **72vmin** 直径，采用三层结构：
  1. **Base Disc**：承载角色脚步光晕，保证主持/专家位于桌沿上方，而非桌内。
  2. **Tool Orbit**：工具卡在此环形轨道上运动，所有卡片均为圆形或扇形，不再出现矩形窗口。
  3. **Core Well**：圆心保留柔光旋涡，用于展示工具加载时的能量聚集。
- 角色定位：
  - 主持（Host）—— 左上 45°，站在桌缘外侧，脚下有细环表示“站位”。
   - 专家（Expert）—— 右上 315° 对称位置。
  - 用户（User）—— 底部中央，始终在桌外，拥有更厚的脚环（强调“第一视角”）。
- 角色说话时，脚环向内扩展至桌面边缘，提示“声音被托盘接引”。

### 3.1.3 道具（Tool）融入托盘的新规则

1. **圆形 QuizCard**：
   - 题干位于中央透镜，选项沿轨道均匀排布成扇区，每个扇区宽 60°，采用玻璃拟态按钮。
   - 选项选中后，对应扇区会亮起淡淡的琥珀光，像在桌面按下一个铭文。
2. **图片/视频**：
   - 媒体内容以弧屏形式沿托盘上半环展开，边缘嵌入柔光框；缩放时保持与桌面法线一致，不可突起过高。
3. **多工具叠加**：
   - 托盘允许一次最多 2 个工具：主工具占核心，辅工具（如 RubricPill）变成漂浮的小泡泡，沿轨道缓慢转圈等待唤起。
4. **回收动画**：
   - 工具完成后缩成“记忆碎片”（8px 光点），沿螺旋轨迹飞往右上空的收藏区；收藏区仅在碎片飞入时亮起，平时隐藏。

### 3.1.4 Breathing Intent + 插话体验补充

- 用户麦克风按钮与脚下脚环同步，长按说话时脚环会向外扩散形成“声波池”。
- Barge-in 时，圆桌整体轻微下压 2px，表示“舞台暂停”，随后主持人脚环熄灭，用户脚环点亮。
- Intent Shortcuts 改为漂浮的 **意图泡泡**：3–4 个小球沿用户脚环上方慢慢转动，点击/语音触发后泡泡破裂成光点，提示“导演已收到”。

### 3.2 交互逻辑 (Interaction Logic)

1.  **进入空间**：
    *   从 Universe 点击泡泡进入。
    *   转场动画：镜头拉近，进入圆桌视角。
    *   开场白：主持人语音欢迎，抛出话题。

2.  **对话流程**：
    *   **AI 发言**：角色头像高亮，播放语音，显示实时字幕。
    *   **用户发言**：
        *   **默认模式**：长按/点击麦克风说话。
        *   **VAD 模式**（可选）：自动检测用户语音。
        *   **兜底交互**：提供“意图气泡”（Intents）如“我没听清”、“举个例子”，点击直接触发语音指令。
        *   **文字输入**：作为辅助，保留一个小键盘入口，用于不方便说话的场景。

3.  **中央互动 (Center Interaction)**：
    *   **触发时机**：当对话进行到关键知识点或需要检验时，主持人引导看“桌面”。
    *   **选择题**：桌面浮现选项卡片。用户可以直接语音说“选A”、“我觉得是第一个”，或者点击卡片。
    *   **图片展示**：桌面展示案例图片，点击可放大。

4.  **退出**：
    *   点击顶部“退出/缩小”按钮，视角拉远，返回 Universe。

### 3.3 关键 UI 元素

*   **Avatar Node**：圆形头像，带有呼吸灯/声波光效。
*   **Center Board**：全息投影风格的面板，承载富媒体内容。
*   **Mic Control**：底部巨大的麦克风按钮，是用户交互的核心锚点。
*   **Subtitle Bubble**：动态浮现的文字气泡，跟随说话人。

- 用户气泡：更实、更亮一点（主观视角）
- 角色气泡：更玻璃、更透一点（“知识从外部来”）
- 不同角色气泡边缘纹理略不同（极细微即可）

## 4. 工具出现不突兀：让“题目/图解”像剧情道具入场

你提的点非常关键：工具不能像突然弹窗打断心流。

### 4.1 Tool Reveal（道具入场）统一动效规则

当调用工具（Quiz/DiagramCard/Rubric）时，遵循同一套“入场仪式”：

1. 当前发言角色先用一句**过渡台词**铺垫
    - “我们来做一个小检验。”
    - “我给你一张对比卡片。”
2. 在对话舞台下方出现一个“**道具托盘**”（Tray）
    - 从底部缓慢升起 12～16px
    - 玻璃面板 + 微光
3. 工具卡片“滑入托盘”并轻微落定（阻尼回弹）
4. 用户交互完成后，工具卡片“收回托盘”或折叠成“学习碎片”飘到右上角（收藏区）

### 4.2 Quiz（选择题）呈现方式

- 不要全屏。
- 用 **QuizCard** 插入到对话流中，但位置固定在“托盘”上，像课堂发下来的小测。
- 选项点击后：
    - 立即反馈选中态
    - 0.3～0.6 秒后给出解释（由角色继续说）

### 4.3 DiagramCard（图解/对比卡）呈现方式

- 以“卡片”形式出现，不要强行“生成图片”才叫科技
- 卡片支持：对比表/因果链/流程图三种模板
- 卡片出现后，角色会引用卡片中的某一行（高亮同步）

### 4.4 RubricScore（费曼/复述评分）不羞辱

- 评分不要像考试判卷
- 用“教练式反馈条”：
    - ✅ 结构清晰
    - ⚠️ 边界条件缺失
    - ➕ 加一个反例会更稳
- 反馈条像“进度刻度”，轻轻点亮

## 5. 关键交互：插话（Interrupt）与节奏控制

你希望用户能随时插话，这会牵涉“导演状态机”，UI 也必须配合。

### 5.1 插话入口

输入区上方有一个小的“插话按钮”（或手势）：

- “我有疑问”
- “展开一点”
- “换个例子”
- “我不信/求证”
- “我懂了，结束”

这些是 UI 层的快捷意图，发给后端作为 `intent_hint`，能显著提高导演决策稳定性。

### 5.2 插话动效（不打断、但要被看见）

- 用户插话时：对话舞台轻微“停镜”0.2s（像主持人抬手示意暂停）
- 当前角色头像光环熄灭，用户头像点亮
- 插话消息气泡上浮，角色回应后恢复节奏

## 6. 一致性：设计 Token 与组件规范（给前端可落地的约束）

### 6.1 Design Tokens（建议字段）

- `--bg-space-0/1/2`
- `--glass-blur`
- `--stroke-soft`
- `--glow-mint / --glow-amber`
- `--text-primary / secondary`
- `--radius-card / radius-bubble`
- `--motion-fast(120ms) / normal(240ms) / slow(420ms)`
- `--spring-damping / stiffness`

### 6.2 组件清单（V1）

Home：

- `BubbleUniverseCanvas`
- `BubbleNode`
- `StarDustLayer`
- `FilterConstellationPanel`

World：

- `WorldStage`
- `AvatarChip`
- `SpeakingHalo`
- `ChatBubble`
- `ToolTray`
- `QuizCard`
- `DiagramCard`
- `RubricPill`
- `IntentShortcuts`

## 7. 典型用户旅程（你想要的“惊艳感”落在流程里）

### 7.1 Journey：从宇宙到课堂

1. 打开 App：泡泡宇宙缓慢呼吸
2. 用户拖动泡泡群，像在拨动星云
3. 某个泡泡被吸引（轻微磁吸），标题更清晰
4. 点击泡泡：镜头推进、门纹浮现、穿越过场
5. 进入课堂：角色头像逐个点亮（像登场）
6. 主持人一句话开场（ENGAGE），经济学家补一句核心（DEFINE）
7. ToolTray 无声升起，出现小测（CHECK）
8. 用户答题，角色立即回应解释（不突兀）
9. 用户插话，舞台短暂停镜，切回后继续
10. 结束时 Exit（TRANSFER+WRAPUP），卡片碎片飘入收藏

## 8. V1 实现建议（Vue 侧落地方向）

### 8.1 泡泡宇宙实现方式（建议）

- 首选：Canvas/WebGL（更丝滑、更像“宇宙”）
- 若先快：SVG + requestAnimationFrame + 简化物理（也能做出浮动感）

物理建议：

- per bubble：`pos, vel, radius, targetRadius, driftNoiseSeed`
- forces：`buoyancy + drag + neighborRepulsion + pointerForce + noise`

### 8.2 世界过场实现

- 用一个全屏 `TransitionPortal` 组件：
    - 负责从 Home 抓取泡泡位置（DOMRect）
    - 动画放大并切换背景
    - 动画结束后挂载 World 页面

### 8.3 Speaking Indicator

- `SpeakingHalo` 用 CSS + SVG/Canvas 波纹
- 由后端事件驱动：
    - `assistant_typing(role)`
    - `assistant_message(role, text)`
    - `tool_call(tool_type)`
    - `tool_result(tool_type, payload)`

## 9. 与后端事件协议（让 UI 不突兀的关键）

建议后端返回“分阶段事件”，而不是一次性塞满：

- `ASSISTANT_THINKING(role, hint)`
- `ASSISTANT_MESSAGE(role, text)`
- `TOOL_PRELUDE(role, text)`（“我们来做个小测”）
- `TOOL_RENDER(tool_type, payload)`
- `TOOL_RESOLVE(tool_type, result)`
- `WRAPUP(text)`

UI 用事件序列驱动动效，工具就不会“突然出现”。

## 10. UI 验收标准（惊艳不是主观，要可验）

1. Home 泡泡群：拖拽/悬停/聚焦都必须“像物理”而不是抖动
2. 进入泡泡过场：必须有“门”的仪式感（镜头推进 + 视觉纹理变化）
3. Speaking Indicator：任何时候用户都知道“谁在说话/谁在思考”
4. Tool 出现：必须经过 ToolTray 入场，不允许突然弹窗
5. 视觉统一：同一泡泡内角色头像风格一致、文本可读、玻璃层次一致
6. 插话可用：用户插话时不破坏舞台节奏，且导演能收到 intent_hint

## 11. 附：一个泡泡的“UI 皮肤”示例（可复制给设计师）

**泡泡：周末加班值不值？**

- 背景：深蓝 + 微暖光斑
- 主持人光环：薄荷青
- 经济学家光环：冷白
- 用户光环：琥珀金
- 卡片风格：对比表模板优先（机会成本 vs 支出 vs 沉没成本）
- 小测：2 题 splitter + 1 题迁移
