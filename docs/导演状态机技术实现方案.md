# å¯¼æ¼”çŠ¶æ€æœºæŠ€æœ¯å®ç°æ–¹æ¡ˆ



## 1. æ€»ä½“æ¶æ„ï¼šæŠŠâ€œå­¦ä¹ å¯¹è¯â€åšæˆä¸€å°äº‹ä»¶é©±åŠ¨çš„ç”µå½±å‰ªè¾‘æœº

æ ¸å¿ƒæ€è·¯ï¼š**å¯¼æ¼”ä¸ç›´æ¥â€œèŠå¤©â€ï¼Œå¯¼æ¼”åªåšâ€œè°ƒåº¦å†³ç­–â€**ã€‚å®é™…å°è¯ç”±â€œæ¼”å‘˜æ¨¡å‹â€ç”Ÿæˆã€‚è¿™æ ·å¯¹è¯æ‰ç¨³å®šã€å¯æ§ã€å¯æ‰©å±•ã€‚

#### 1.1 å…³é”®ç»„ä»¶

- **Session Orchestratorï¼ˆä¼šè¯ç¼–æ’å™¨ï¼‰**ï¼šäº‹ä»¶å¾ªç¯ï¼Œç»´æŠ¤ session çŠ¶æ€ï¼Œè°ƒç”¨å¯¼æ¼”ã€æ¼”å‘˜ã€é¢˜ç›®ç”Ÿæˆå™¨ã€‚
- **Director Engineï¼ˆå¯¼æ¼”å¼•æ“ï¼‰**ï¼šè¾“å…¥çŠ¶æ€ + ç”¨æˆ·è¯è¯­ â†’ è¾“å‡º `DirectorPlan`ï¼ˆä¸‹ä¸€æ‹ç‚¹ã€è§’è‰²ã€è¾“å‡ºåŠ¨ä½œã€èŠ‚å¥ã€æ ˆæ“ä½œï¼‰ã€‚
- **Actor Engineï¼ˆæ¼”å‘˜å¼•æ“ï¼‰**ï¼šæŒ‰ `DirectorPlan` + Beat æŒ‡ä»¤å¡ç”Ÿæˆä¸‹ä¸€æ®µå°è¯ï¼ˆæ–‡æœ¬/è¯­éŸ³è„šæœ¬ï¼‰ã€‚
- **Assessment Engineï¼ˆæµ‹è¯„å¼•æ“ï¼‰**ï¼šè‡ªé€‚åº”æµ‹è¯„ã€æ‹ç‚¹ä¸­çš„å¿«é¢˜ã€ExitTicketã€‚
- **Knowledge/Asset Layerï¼ˆçŸ¥è¯†ä¸ç´ æå±‚ï¼‰**ï¼šæ¦‚å¿µå›¾è°±ã€æƒ…å¢ƒæ¨¡æ¿ã€è¯¯è§£æ ‡ç­¾ã€æ•…äº‹/æ¼«ç”»/å›¾è§£ç´ æã€‚
- **Memory Layerï¼ˆè®°å¿†å±‚ï¼‰**ï¼šä¼šè¯çŸ­æœŸè®°å¿† + ç”¨æˆ·é•¿æœŸå­¦ä¹ ç”»åƒ + å¤–éƒ¨èµ„æ–™ï¼ˆå¯é€‰ï¼‰ã€‚
- **Realtime Voice I/Oï¼ˆå®æ—¶è¯­éŸ³äº¤äº’ï¼‰**ï¼šASR æµå¼è¯†åˆ« + TTS æµå¼æ’­æ”¾ + æ’è¯ä¸­æ–­ï¼ˆbarge-inï¼‰ã€‚



## 2. æ ¸å¿ƒå¯¹è±¡ä¸æ•°æ®ç»“æ„ï¼šä¸€åˆ‡éƒ½ç»“æ„åŒ–ï¼Œå¯¼æ¼”åªâ€œå¡«è¡¨â€

### 2.1 Bubble / Entryï¼ˆæ³¡æ³¡å…¥å£ï¼‰

> æ³¡æ³¡ä¸æ˜¯â€œæ¦‚å¿µåâ€ï¼Œæ˜¯â€œæƒ…å¢ƒå…¥å£â€ï¼Œä½†å¿…é¡»èƒ½æ˜ å°„åˆ°æ¦‚å¿µéª¨æ¶ã€‚

```json
{
  "entry_id": "econ_offer_weekend_worthit",
  "domain": "economics",
  "title": "å‘¨æœ«åŠ ç­å€¼ä¸å€¼ï¼Ÿ",
  "hook": "ä½ ä»¥ä¸ºèµšäº†800ï¼Œå…¶å®å¯èƒ½äºäº†æ›´è´µçš„ä¸œè¥¿ã€‚",
  "primary_concept_id": "econ_opportunity_cost",
  "secondary_concepts": ["econ_time_preference"],
  "scenario_id": "scn_weekend_tradeoff",
  "difficulty_hint": 2
}
```

### 2.2 Concept Packï¼ˆæ¦‚å¿µè¯¾åŒ…éª¨æ¶ï¼‰

å¯¼æ¼”ä¸é¢˜ç›®ç”Ÿæˆå¿…é¡»ä¾èµ–å®ƒï¼Œé¿å…â€œéšå£èƒ¡è¯´â€ã€‚

```json
{
  "concept_id": "econ_opportunity_cost",
  "core_relation": "æœºä¼šæˆæœ¬=æ”¾å¼ƒçš„æœ€å¥½æ›¿ä»£é€‰æ‹©çš„ä»·å€¼ï¼ˆä¸æ˜¯æ”¯å‡ºæœ¬èº«ï¼‰",
  "misconceptions": [
    {"tag": "M1_cost_equals_money_spent", "splitter_prompt": "æŠŠæœºä¼šæˆæœ¬è¯¯è®¤ä¸ºèŠ±å‡ºå»çš„é’±"},
    {"tag": "M2_sunk_cost_confusion", "splitter_prompt": "æ··æ·†æ²‰æ²¡æˆæœ¬ä¸æœºä¼šæˆæœ¬"}
  ],
  "boundaries": ["å½“æ›¿ä»£é€‰æ‹©ä¸æ˜ç¡®æ—¶ï¼Œç”¨'æœ€å¥½æ›¿ä»£'å®šä¹‰ä¼šå˜æ¨¡ç³Šï¼Œéœ€è¦è¡¥å……å‡è®¾"],
  "story_assets": ["asset_story_offer", "asset_story_queue"],
  "transfer_targets": ["product_scope_tradeoff", "policy_budget_tradeoff"]
}
```

### 2.3 SessionStateï¼ˆä¼šè¯çŠ¶æ€ï¼‰

è¿™æ˜¯å¯¼æ¼”å¼•æ“çš„â€œè¾“å…¥ç”»æ¿â€ã€‚

```json
{
  "session_id": "...",
  "entry_id": "...",
  "main_objective": "ç”¨æœºä¼šæˆæœ¬çš„é•œå¤´è§£é‡Šå–èˆï¼Œå¹¶èƒ½åŒºåˆ†å®ƒä¸æ”¯å‡º/æ²‰æ²¡æˆæœ¬",
  "act": 2,
  "stage": "SEMINAR",
  "beat": "TwistBeat",
  "mastery_estimate": 0.42,
  "misconception_tags": ["M1_cost_equals_money_spent"],
  "output_clock_sec": 83,
  "tension_level": 3,
  "cognitive_load": 2,
  "pacing_mode": "NORMAL",
  "question_stack": [
    {"q": "é‚£æ˜¯ä¸æ˜¯æ‰€æœ‰é€‰æ‹©éƒ½èƒ½ç®—å‡ºæœºä¼šæˆæœ¬ï¼Ÿ", "urgency": 2, "at_beat": "RevealBeat"}
  ],
  "signals": {
    "turns": 9,
    "avg_latency_ms": 950,
    "interruptions": 2,
    "user_output_quality": 0.55,
    "affect_proxy": {"confusion": 0.6, "boredom": 0.1, "frustration": 0.2}
  }
}
```

### 2.4 DirectorPlanï¼ˆå¯¼æ¼”å†³ç­–è¾“å‡ºï¼‰

å¯¼æ¼”å¼•æ“åªäº§å‡ºè¿™ä¸ªï¼Œç¡®ä¿ç³»ç»Ÿå¯æ§ã€‚

```json
{
  "user_mind_state": ["Partial", "Verify"],
  "intent": "Deepen",
  "next_beat": "LensShiftBeat",
  "next_role": "Expert",
  "output_action": "OneSentenceRecap",
  "talk_burst_limit_sec": 35,
  "tension_goal": "maintain",
  "load_goal": "maintain",
  "stack_action": {"type": "keep"},
  "notes": "æ¢è§†è§’è§£é‡Šï¼Œç¨³å®šæ ¸å¿ƒå…³ç³»ï¼Œå¹¶ç«‹åˆ»è®©ç”¨æˆ·å¤è¿°æ ¡å‡†"
}
```

------

## 3. æ‰§è¡Œå¾ªç¯ï¼šäº‹ä»¶é©±åŠ¨çš„â€œå¯¼æ¼”-æ¼”å‘˜-è§‚ä¼—â€å›åˆåˆ¶

### 3.1 é«˜å±‚äº‹ä»¶æµ

1. ç”¨æˆ·ç‚¹å‡»æ³¡æ³¡ â†’ `ENTER`
2. `DIAGNOSE`ï¼šæµ‹è¯„å¼•æ“å‡º 2â€“4 é¢˜ â†’ æ›´æ–° `mastery_estimate/misconceptions`
3. `SEMINAR`ï¼šå¾ªç¯æ‰§è¡Œæ‹ç‚¹
4. ç”¨æˆ·è¯·æ±‚ç»“æŸ or è¾¾åˆ°æ”¶æŸæ¡ä»¶ â†’ `EXIT`ï¼šExitTicket
5. å†™å›ç”¨æˆ·æ¨¡å‹ â†’ `UPDATE` â†’ å›é¦–é¡µæ³¡æ³¡æ›´æ–°

### 3.2 Seminar å›åˆï¼ˆå…³é”®ï¼‰

æ¯å›åˆå¤„ç†ä¸€ä¸ªâ€œæ‹ç‚¹â€ï¼š

- æ”¶é›†è¾“å…¥ï¼š`UserUtterance + LastTurnsSummary + SessionState`
- è°ƒç”¨å¯¼æ¼”ï¼š`DirectorEngine(...) -> DirectorPlan`
- æ ¹æ® DirectorPlan é€‰æ‹© Beat æŒ‡ä»¤å¡ï¼Œæ„é€ ç»™æ¼”å‘˜çš„â€œå°è¯ä»»åŠ¡ä¹¦â€
- è°ƒç”¨æ¼”å‘˜ç”Ÿæˆå°è¯ï¼ˆæ–‡æœ¬/è¯­éŸ³è„šæœ¬ï¼‰
- æ’­æ”¾ï¼ˆTTSï¼‰æˆ–å±•ç¤ºæ–‡æœ¬
- ç­‰å¾…ç”¨æˆ·æ’è¯ï¼ˆå« barge-inï¼‰å¹¶è®°å½•ä¿¡å·
- æ›´æ–°çŠ¶æ€ï¼šOutputClockã€MindStateã€æ ˆã€è¯¯è§£æ ‡ç­¾ã€æŒæ¡åº¦

------

## 4. å¯¼æ¼”å¼•æ“å®ç°ï¼šè§„åˆ™ç¡¬çº¦æŸ + LLM è½¯å†³ç­–çš„æ··åˆç­–ç•¥

å¯¼æ¼”ä¸èƒ½çº¯ LLMï¼ˆå¤ªæ¼‚ï¼‰ï¼Œä¹Ÿä¸èƒ½çº¯è§„åˆ™ï¼ˆå¤ªæ­»ï¼‰ã€‚æ¨è **Hybrid Policy**ï¼š

### 4.1 ä¸‰å±‚å†³ç­–æ¡†æ¶

#### Layer Aï¼šç¡¬çº¦æŸæ ¡éªŒï¼ˆDeterministic Guardrailsï¼‰

åœ¨è°ƒç”¨ LLM æˆ–æ¥å—å…¶è¾“å‡ºå‰ï¼Œå…ˆåšç¡¬çº¦æŸï¼š

- `output_clock_sec >= 90` â†’ next_beat å¿…é¡» âˆˆ {CheckBeat, FeynmanBeat, MiniGameBeat, TransferSwap, ExitTicket}
- ç”¨æˆ·è¯´â€œæ‡‚äº†/ç»“æŸâ€ â†’ next_beat å¿…é¡»æ˜¯ ExitTicket æˆ– Transfer æ£€éªŒ
- Branch â†’ é»˜è®¤å…¥æ ˆ + BranchTeaserBeatï¼ˆé™¤éä¸å½“å‰è¯¯è§£å¼ºç›¸å…³ï¼Œæ‰å¯é™ä¸º Deepenï¼‰

#### Layer Bï¼šæ„å›¾/å¿ƒæ™ºçŠ¶æ€è¯†åˆ«ï¼ˆLLM + Heuristicï¼‰

- **Heuristic** å…ˆç²—åˆ¤ï¼šå…³é”®è¯ã€æ˜¯å¦é—® why/howã€æ˜¯å¦ææ–°æ¦‚å¿µåã€æ˜¯å¦è¯·æ±‚æ¢é£æ ¼ã€æ˜¯å¦å¤§é‡â€œå—¯/æ‡‚äº†â€
- **LLM Router** ç²¾åˆ¤è¾“å‡ºï¼š`UserMindState` + `Intent` + `Confidence`
- æœ€ç»ˆç”¨åŠ æƒèåˆï¼šheuristic å…œåº•ï¼ŒLLM è´Ÿè´£ç»†è…»åˆ¤æ–­

#### Layer Cï¼šæ‹ç‚¹é€‰æ‹©ï¼ˆBeat Strategy Mappingï¼‰

ä¸å†ä½¿ç”¨å¤æ‚çš„â€œå€™é€‰é›†+æ‰“åˆ†â€ï¼Œè€Œæ˜¯ç›´æ¥åŸºäº **UserMindStateï¼ˆç”¨æˆ·å¿ƒç†çŠ¶æ€ï¼‰** æ˜ å°„åˆ° **Beat Strategyï¼ˆå¯¼æ¼”æ•‘åœºç­–ç•¥ï¼‰**ã€‚è¿™ç§æ–¹å¼æ›´ç›´è§‚ã€æ›´ç¬¦åˆäººç±»å¯¼æ¼”çš„ç›´è§‰ã€‚

| ç”¨æˆ·å¿ƒç†çŠ¶æ€ (UserMindState) | çŠ¶æ€ç‰¹å¾ (Signals) | å¯¼æ¼”çš„â€œæ•‘åœºâ€ç­–ç•¥ (Beat Strategy) | æ‰§è¡ŒåŠ¨ä½œ |
| :--- | :--- | :--- | :--- |
| **1. è¿·é›¾ (Fog) ğŸŒ«ï¸** | é€»è¾‘å‘æ•£ï¼Œåå¤é—®â€œåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿâ€ï¼Œè¡¨ç°ç„¦è™‘ã€‚ | **RevealBeat** | ä¸“å®¶é—­å˜´ï¼Œæ¢åŒä¼´ç”¨æœ€é€šä¿—çš„æ¯”å–»é‡æ„æ¨¡å‹ï¼ˆé™ç»´æ‰“å‡»ï¼‰ã€‚ |
| **2. é”™è§‰ (Illusion) ğŸ¤¡** | è§‰å¾—è‡ªå·±æ‡‚äº†ï¼Œä½†å¤è¿°ç©ºæ´ï¼Œåªæœ‰â€œå—¯/æ‡‚äº†â€ã€‚ | **TwistBeat / CheckBeat** | ç›´æ¥æ‰”ä¸ªâ€œæ‰“è„¸é¢˜â€æˆ–åä¾‹ï¼Œæˆ³ç ´æ³¡æ²«ã€‚ |
| **3. åŠæ‡‚ (Partial) ğŸŒ“** | èƒ½è¯´å‡ºç‚¹é€»è¾‘ï¼Œä½†ä¸€ç¢°è¾¹ç•Œå°±ä¹±ã€‚ | **LensShiftBeat** | æ¢ä¸ªé•œå¤´è§†è§’é‡æ–°è§£é‡Šï¼Œç›´åˆ°è¾¹ç•Œæ¸…æ™°ã€‚ |
| **4. é¡¿æ‚Ÿ (Aha!) ğŸ’¡** | æŠ“ä½æ ¸å¿ƒå…³ç³»ï¼Œè§£é‡Šå˜æ¸…æ™°ï¼Œè¯­è°ƒå˜å…´å¥‹ã€‚ | **FeynmanBeat** | è¶çƒ­æ‰“é“ï¼Œè®©ä½ ç»“æ„åŒ–åœ°è®²ç»™â€œç¬¨è›‹åŒä¼´â€å¬ã€‚ |
| **5. æ±‚è¯ (Verify) ğŸ”** | å¼€å§‹ä¸»åŠ¨é—®åä¾‹ã€é€‚ç”¨æ¡ä»¶å’Œä¸¥è°¨å®šä¹‰ã€‚ | **Deepen** | å¼•å…¥æŒ‘æˆ˜è€…è§’è‰²ï¼Œç»™æ›´æ·±å±‚çš„æœºåˆ¶é“¾ã€‚ |
| **6. å¤–æ‰© (Expand) ğŸš€** | ä¸»åŠ¨è”æƒ³åˆ°ç°å®æ¡ˆä¾‹æˆ–å…¶ä»–é¢†åŸŸã€‚ | **MontageBeat** | å¼€å¯â€œè¿ç§»è’™å¤ªå¥‡â€ï¼Œåœ¨ä¸åŒåœºæ™¯ä¸­å¿«é€Ÿåˆ‡æ¢ã€‚ |
| **7. ç–²æƒ« (Fatigue) ğŸ¥±** | è¾“å‡ºå˜çŸ­ï¼ˆå¦‚â€œå“¦â€ã€â€œè¡Œâ€ï¼‰ï¼Œå“åº”å»¶è¿Ÿå˜é•¿ã€‚ | **MiniGameBeat / Cooldown** | ç«‹åˆ»åœè¯¾ç©æ¸¸æˆï¼Œæˆ–å¯åŠ¨ CooldownBeat å¼ºè¡Œæ”¶å°¾ã€‚ |

### 4.2 è¯„åˆ†ç‰¹å¾ï¼ˆå·²åºŸå¼ƒï¼‰

*åŸæœ‰çš„å¤æ‚æ‰“åˆ†é€»è¾‘ï¼ˆgain/curve/fitï¼‰å·²ç®€åŒ–ä¸ºä¸Šè¿°ç›´æ¥æ˜ å°„è¡¨ã€‚*

------

## 5. æ¼”å‘˜å¼•æ“å®ç°ï¼šPrompt Constructionï¼ˆæç¤ºè¯æ„å»ºï¼‰

åœ¨æ–°çš„æ¶æ„ä¸‹ï¼Œæ¼”å‘˜å¼•æ“ä¸å†ç›´æ¥ç”Ÿæˆå°è¯æ–‡æœ¬ï¼Œè€Œæ˜¯è´Ÿè´£**æ„å»ºå‘ç»™ GPT Realtime çš„ System Instructions æˆ– Session Update**ã€‚

### 5.1 ç»™æ¼”å‘˜çš„è¾“å…¥æ„é€ 

- **DirectorPlan**ï¼šå½“å‰æ‹ç‚¹ç­–ç•¥ï¼ˆBeat Strategyï¼‰ã€ç›®æ ‡è§’è‰²ï¼ˆRoleï¼‰ã€å¿…é¡»å¼•å¯¼çš„è¾“å‡ºåŠ¨ä½œï¼ˆOutputActionï¼‰ã€‚
- **Concept Pack**ï¼šæ ¸å¿ƒæ¦‚å¿µéª¨æ¶ã€å½“å‰è¯¯è§£æ ‡ç­¾ã€è¾¹ç•Œç‚¹ã€‚
- **User Context**ï¼šç”¨æˆ·å½“å‰çš„å¿ƒç†çŠ¶æ€ï¼ˆUserMindStateï¼‰ã€å·²ç¡®è®¤çš„èƒŒæ™¯ä¿¡æ¯ã€‚

### 5.2 è¾“å‡ºï¼šRealtime Instructions

æ¼”å‘˜è¾“å‡ºçš„æ˜¯ä¸€æ®µç»“æ„åŒ–çš„ Promptï¼Œç”¨äºæŒ‡å¯¼ GPT Realtime å¦‚ä½•è¯´è¯ï¼š

- **Role Definition**ï¼šæ˜ç¡®å½“å‰è§’è‰²çš„è¯´è¯é£æ ¼ï¼ˆå¦‚â€œä¸¥è°¨çš„ç»æµå­¦å®¶â€æˆ–â€œé€šä¿—çš„å’–å•¡åº—è€æ¿â€ï¼‰ã€‚
- **Task Instruction**ï¼šæ˜ç¡®å½“å‰çš„ä»»åŠ¡ï¼ˆå¦‚â€œç”¨æ¯”å–»è§£é‡Šæœºä¼šæˆæœ¬â€ã€â€œåé—®ç”¨æˆ·æ˜¯å¦ç†è§£â€ï¼‰ã€‚
- **Constraints**ï¼šæ˜ç¡®çº¦æŸæ¡ä»¶ï¼ˆå¦‚â€œå›ç­”ä¸è¶…è¿‡ 2å¥â€ã€â€œä¸è¦ä½¿ç”¨ä¸“ä¸šæœ¯è¯­â€ï¼‰ã€‚

------

## 6. æµ‹è¯„ä¸é¢˜ç›®æ³¨å…¥ï¼šè‡ªé€‚åº”æµ‹è¯„ + æ‹ç‚¹å†…â€œå¾®æµ‹è¯„â€

### 6.1 é¢˜å‹æ¨¡æ¿åº“ï¼ˆç»“æ„åŒ–ç”Ÿæˆï¼‰

- Misconception Splitterï¼šæ¯ä¸ªé€‰é¡¹å¯¹åº”ä¸€ä¸ªè¯¯è§£æ ‡ç­¾
- Boundary Probeï¼šé€‚ç”¨/ä¸é€‚ç”¨æ¡ä»¶
- Transfer Swapï¼šæ¢åœºæ™¯åŒç»“æ„
- Feynman Rubricï¼šå¥å¼è„šæ‰‹æ¶ + è¯„åˆ†è¦ç‚¹ï¼ˆå…³ç³»è¯/æ¡ä»¶/ç»“æœï¼‰

### 6.2 è‡ªé€‚åº”ç­–ç•¥ï¼ˆV1 ç®€åŒ–ï¼‰

- åˆå§‹ï¼š1 é“æç®€å•é¢˜ï¼ˆå»ºç«‹ä¿¡å¿ƒï¼‰
- è‹¥æ­£ç¡®ä¸”è§£é‡Šå¼ºï¼šè·³åˆ°è¿ç§»é¢˜
- è‹¥æ­£ç¡®ä½†è§£é‡Šå¼±ï¼šå‡º Splitter/Boundary
- è‹¥é”™è¯¯ä½†æ¨ç†ä¸°å¯Œï¼šå‡ºæ›´æ¸…æ™°çš„ Check + LensShift
- è‹¥é”™è¯¯ä¸”å‘½ä¸­è¯¯è§£ï¼šTwistBeat + Splitter

> å…³é”®æ˜¯æŠŠâ€œè¯¯è§£æ ‡ç­¾â€å½“ä¸€ç­‰å…¬æ°‘ï¼Œé¢˜ç›®æ˜¯â€œæ‰“æ ‡ç­¾çš„æ¢é’ˆâ€ã€‚

------

## 7. åˆ†å‰é—®é¢˜æ ˆï¼ˆQuestionStackï¼‰ï¼šè®©ç”¨æˆ·è‡ªç”±ï¼Œä½†ä¸»çº¿ä¸æ•£

### 7.1 å…¥æ ˆç­–ç•¥

Branch åˆ¤å®šåå…¥æ ˆï¼Œè®°å½•ï¼š

- `question`
- `stage_at_ask`
- `urgency`ï¼ˆç”¨æˆ·æ˜¯å¦å¼ºçƒˆè¦æ±‚ç«‹åˆ»ç­”ï¼‰
- `link_to_objective`ï¼ˆä¸ä¸»ç›®æ ‡ç›¸å…³åº¦ï¼‰

### 7.2 å›æ”¶ç­–ç•¥ï¼ˆç‰‡å°¾å½©è›‹/Act IIIï¼‰

- æ¯æ¬¡åªå›æ”¶ 1 ä¸ª
- è‹¥ç›¸å…³åº¦é«˜ï¼šå½“ä½œ Deepen
- è‹¥ç›¸å…³åº¦ä½ï¼šç”Ÿæˆæ–°æ³¡æ³¡å…¥å£ï¼ˆEntryï¼‰å¹¶æ”¾é¦–é¡µæ¨è

------

## 8. å®æ—¶è¯­éŸ³æ’è¯ï¼ˆbarge-inï¼‰ï¼šç”µå½±æ„Ÿçš„å…³é”®å·¥ç¨‹ç‚¹

å¦‚æœä½ è¦â€œç”¨æˆ·å¯å®æ—¶æ’è¯â€ï¼Œå¿…é¡»åš **æµå¼ ASR + å¯ä¸­æ–­ TTS**ã€‚

### 8.1 æŠ€æœ¯æœºåˆ¶

- TTS æ’­æ”¾æ—¶å¹¶è¡Œå¼€ ASR ç›‘å¬
- ç›‘å¬åˆ°ç”¨æˆ·è¯­éŸ³èƒ½é‡ + è¯†åˆ«ç½®ä¿¡åº¦è¾¾é˜ˆå€¼ â†’ **ç«‹å³æš‚åœ TTS**
- å°†â€œè¢«æ‰“æ–­çš„æ¼”å‘˜å°è¯â€æ ‡è®°ä¸º `interrupted=true`ï¼Œå†™å…¥å¯¹è¯å†å²
- å¯¼æ¼”å¼•æ“æ¥æ”¶ `UserUtterance`ï¼Œå¹¶æŠŠ `interruptions++` ä½œä¸ºä¿¡å·è¾“å…¥ï¼ˆä»£è¡¨ç”¨æˆ·å‚ä¸æ„Ÿå¾ˆå¼ºæˆ–ä¸è€çƒ¦ï¼‰

### 8.2 è¢«æ‰“æ–­åçš„å¯¼æ¼”ç­–ç•¥

- è‹¥ç”¨æˆ· Clarifyï¼šç«‹åˆ» Check æˆ–çŸ­ Clarifyï¼Œå†å›åˆ°ä¸Šä¸€æ‹ç‚¹ç»§ç»­ï¼ˆå¿…è¦æ—¶ç”¨ Cooldown æ”¶æŸï¼‰
- è‹¥ç”¨æˆ· Branchï¼šå…¥æ ˆ + BranchTeaserï¼ˆç»™é€‰æ‹©ï¼‰
- è‹¥ç”¨æˆ· Off-topicï¼šè½»æ¥ä½åç”¨ Hook æ‹‰å›

------

## 9. æŒæ¡åº¦ä¸â€œæœ‰æ•ˆè¾“å‡ºè´¨é‡â€æ›´æ–°ï¼šå¯¼æ¼”çŠ¶æ€æœºçš„ç‡ƒæ–™

### 9.1 è¾“å‡ºè´¨é‡è¯„åˆ†ï¼ˆè½»é‡å¯å®ç°ï¼‰

æŠŠç”¨æˆ·è¾“å‡ºæ˜ å°„åˆ° 0â€“1ï¼š

- æ˜¯å¦åŒ…å«å…³ç³»è¯ï¼ˆå› æœ/æƒè¡¡ï¼‰
- æ˜¯å¦æåˆ°æ¡ä»¶/è¾¹ç•Œï¼ˆL4ï¼‰
- æ˜¯å¦èƒ½ä¸¾å‡ºè‡ªæ´½ä¾‹å­
- æ˜¯å¦èƒ½åŒºåˆ†ç›¸è¿‘æ¦‚å¿µï¼ˆè¯¯è§£æ¶ˆé™¤ï¼‰

è¿™å¯ä»¥å…ˆç”¨è§„åˆ™ + LLM åˆ¤åˆ†ç»“åˆï¼š

- è§„åˆ™ï¼šå…³é”®è¯/ç»“æ„ï¼ˆbecause/therefore/if-thenï¼‰
- LLMï¼šç»™å‡º rubric æ‰“åˆ†ä¸ä¸€å¥è§£é‡Šï¼ˆä¸å±•ç¤ºç»™ç”¨æˆ·ï¼‰

### 9.2 Mastery æ›´æ–°ï¼ˆV1ï¼‰

ä¸€ä¸ªå¯ç”¨çš„æ›´æ–°å¼ï¼š

- `mastery += Î± * (quiz_signal + output_quality_signal + transfer_signal) - Î² * misconception_pressure`
- `misconception_pressure` åœ¨ Twist/Boundary å‘½ä¸­çº æ­£åä¸‹é™

------

## 10. æ¦‚å¿µå›¾è°±ä¸è·¨é¢†åŸŸæ‰©å±•ï¼šç»æµå­¦åªæ˜¯ä¸€ä¸ª domain

ä¸ºäº†ä¸è¢«é¢†åŸŸé”æ­»ï¼Œå¯¼æ¼”çŠ¶æ€æœºå±‚é¢åªè®¤ï¼š

- `domain`
- `primary_concept_id`
- `core_relation`
- `misconceptions`
- `boundaries`
- `transfer_targets`

ç»æµå­¦/ç¼–ç¨‹/å†å²åªæ˜¯ Concept Pack çš„ä¸åŒå®ä¾‹ã€‚
æ³¡æ³¡â€œæ›´æœ‰è¶£â€çš„ç”Ÿæˆï¼Œæœ¬è´¨æ˜¯ `Scenario -> Concept` çš„æ˜ å°„ä¸æ”¹å†™ï¼ˆtitle/hookï¼‰ï¼Œä¸ä¼šå½±å“å¯¼æ¼”çš„æ§åˆ¶é€»è¾‘ã€‚

------

## 11. æ¨èçš„å®ç°å½¢æ€ï¼šåŒæ¨¡å‹ç¼–æ’ï¼ˆå¼ºçƒˆå»ºè®®ï¼‰

### 11.1 ä¸ºä»€ä¹ˆè¦åŒæ¨¡å‹

- å¯¼æ¼”æ¨¡å‹ï¼šå°è¾“å‡ºã€å¼ºç»“æ„ã€ç¨³å®šè·¯ç”±ï¼ˆä¾¿å®œä¸”å¯æ§ï¼‰
- æ¼”å‘˜æ¨¡å‹ï¼šè´Ÿè´£è¯­è¨€ã€æ•…äº‹ã€è§’è‰²é£æ ¼ï¼ˆæ›´â€œåƒå¤§ç‰‡â€ï¼‰

è¿™èƒ½æŠŠâ€œå¯æ§æ€§â€ä¸â€œè¡¨ç°åŠ›â€åˆ†å¼€ï¼Œé¿å…ä¸€ä¸ªæ¨¡å‹æ—¢è¦ç®¡ç»“æ„åˆè¦æ¼”æˆå¯¼è‡´æ¼‚ç§»ã€‚

------

## 12. ä¸€æ®µâ€œå¯è½åœ°â€çš„ä¼ªä»£ç çº§æ‰§è¡Œï¼ˆç®€åŒ–ç¤ºæ„ï¼‰

```text
while session.active:
  event = wait(user_input or tts_finished or timeout)

  update_signals(event)

  if state.stage == DIAGNOSE:
     q = assessment.next_question(state)
     ask(q)
     continue

  director_plan = director(state, last_turns, user_input)
  director_plan = apply_guardrails(director_plan, state)

  beat_card = BeatLibrary[director_plan.next_beat]
  actor_prompt = build_actor_prompt(state, director_plan, beat_card, concept_pack)

  actor_line = actor(actor_prompt)
  speak_or_show(actor_line)

  state = reducer(state, director_plan, actor_line, event)
```

